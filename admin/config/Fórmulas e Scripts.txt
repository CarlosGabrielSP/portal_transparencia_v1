FÓRMULAS EXCEL

*EXTRAIR SOMENTE DÍGITOS VÁLIDOS DO VALOR EMPENHO:
=(EXT.TEXTO(C2;1;NÚM.CARACT(C2)-4))/100

*CORRIGIR DATA
=DATA.VALOR(SUBSTITUIR(EXT.TEXTO(F2;1;10);".";"/"))

*SELECIONAR NOME DA ENTIDADES DE GURUPÁ A PARTIR DO CÓDIGO:
=SE(P2=1;"PREFEITURA MUNICIPAL DE GURUPÁ";SE(P2=2;"CÂMARA MUNICIPAL";SE(P2=3;"FUNDO MUNICIPAL DE SAÚDE";SE(P2=4;"FUNDEB";SE(P2=5;"FUNDO MUNICIPAL DE ASSITÊNCIA SOCIAL";SE(P2=6;"SECRETARIA DE EDUCAÇÃO, CULTURA E DESPORTO";SE(P2=7;"SAAE/SAA GARUPA";SE(P2=8;"FUNDO MUNICIPAL DOS DIREITOS DA CRIANÇA";""))))))))

*SCRIPT EXTRAI EMPENHOS:
SELECT D.NEMPG AS EMPENHO, F.NOME, D.VADEM AS VALOR, D.PRODU AS HISTORICO, D.TPEM, D.DATAE, D.LICIT,
(DESDIS.PODER||DESDIS.ORGAO||TABUNIDADE.UNIDADE||' - '||CASE WHEN DESDIS.EXTRA='S' THEN EXTRA.DESCRICAO ELSE TABUNIDADE.NOME END) AS UNIDADE,
TABFUNCAO.NOME AS FUNCAO, TABSUBFUNCAO.NOME AS SUBFUNCAO, (DESDIS.CATEC||' - '||TABCATEC.NOME) AS NATUREZA,
(COALESCE(D.FRC, DESDIS.FONCODIGO)||' - '||FONCODIGO.FONCODIGODESC) AS FONTE,
TABEMPRESA.NOME AS ORGAO, EXTRACT(YEAR FROM D.DATAE) AS EXERCICIO
FROM DESPES D
INNER   JOIN DESDIS         ON DESDIS.FICHA = D.FICHA
INNER   JOIN DESFOR F       ON F.CODIF = D.CODIF
INNER   JOIN TABEMPRESA     ON TABEMPRESA.EMPRESA = DESDIS.EMPRESA
LEFT    JOIN TABFUNCAO      ON TABFUNCAO.FUNCAO = DESDIS.FUNCAO
LEFT    JOIN TABSUBFUNCAO   ON TABSUBFUNCAO.SUBFUNCAO = DESDIS.SUBFUNCAO
LEFT    JOIN TABUNIDADE     ON TABUNIDADE.PODER = DESDIS.PODER AND TABUNIDADE.ORGAO = DESDIS.ORGAO AND TABUNIDADE.UNIDADE = DESDIS.UNIDADE 
LEFT    JOIN TABCATEC       ON TABCATEC.CATEC = DESDIS.CATEC
LEFT    JOIN FONCODIGO      ON FONCODIGO.FONCODIGO = COALESCE(D.FRC, DESDIS.FONCODIGO) 
LEFT    JOIN EXTRA          ON EXTRA.EMPRESA=DESDIS.EMPRESA AND EXTRA.EXTRA=DESDIS.FICHA_EXTRA

*SCRIPT EXTRAI LIQUIDAÇÕES POR EMPENHO E TIPO DE EMPENHO:
SELECT D.TPEM AS TIPO, D.NEMPG AS EMPENHO, L.DATAE AS DATA, L.VADEM AS VALOR, EXTRACT(YEAR FROM L.DATAE) AS ANO, TABEMPRESA.NOME AS ORGAO
FROM VIEWLIQ AS L
INNER JOIN DESPES D ON D.PKEMP = L.PKEMP
INNER JOIN DESDIS ON DESDIS.FICHA = D.FICHA
INNER JOIN TABEMPRESA ON TABEMPRESA.EMPRESA = DESDIS.EMPRESA
ORDER BY DATA DESC

*SCRIPT EXTRAI PAGAMENTOS POR EMPENHO E TIPO DE EMPENHO:
SELECT D.TPEM AS TIPO, D.NEMPG AS EMPENHO, P.NUMSUB AS PARCELA, P.DTPAG AS DATA, P.VAPAG AS VALOR,
D.DESCO AS DESCONTO, (P.VAPAG - D.DESCO) AS VALPAGO, EXTRACT(YEAR FROM P.DTPAG) AS ANO, TABEMPRESA.NOME AS ORGAO
FROM VIEWVAPAG P
INNER JOIN DESPES D ON P.PKEMP = D.PKEMP
INNER JOIN DESDIS ON DESDIS.FICHA = D.FICHA
INNER JOIN TABEMPRESA ON TABEMPRESA.EMPRESA = DESDIS.EMPRESA
ORDER BY DATA DESC